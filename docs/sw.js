const CACHE_NAME="app-cache-v1",DATA_CACHE_NAME="data-cache-v1",FILES_TO_CACHE=["./","./index.html","./favicon.png","./styles/styles.css","./scripts/index.js","./scripts/pages/home/home-page.js","./scripts/pages/home/home-presenter.js","./scripts/pages/add/add-presenter.js","./scripts/utils/indexeddb.js","./scripts/config.js"];self.addEventListener("install",(e=>{console.log("[ServiceWorker] Install"),e.waitUntil(caches.open(CACHE_NAME).then((e=>(console.log("[ServiceWorker] Pre-caching offline page"),e.addAll(FILES_TO_CACHE)))).catch((e=>{console.error("[ServiceWorker] Pre-caching failed:",e)}))),self.skipWaiting()})),self.addEventListener("activate",(e=>{console.log("[ServiceWorker] Activate"),e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{if(e!==CACHE_NAME&&"data-cache-v1"!==e)return console.log("[ServiceWorker] Removing old cache",e),caches.delete(e)})))))),self.clients.claim()})),self.addEventListener("fetch",(e=>{e.request.url.includes("/stories")?e.respondWith(caches.open("data-cache-v1").then((t=>fetch(e.request).then((s=>(200===s.status&&t.put(e.request.url,s.clone()),s))).catch((()=>t.match(e.request)))))):e.respondWith(caches.match(e.request).then((t=>t||fetch(e.request))))})),self.addEventListener("push",(e=>{console.log("[ServiceWorker] Push Received.");let t={};e.data&&(t=e.data.json());const s=t.title||"New Notification",c={body:t.body||"You have a new message.",icon:"/favicon.png",badge:"/favicon.png"};e.waitUntil(self.registration.showNotification(s,c))})),self.addEventListener("notificationclick",(e=>{console.log("[ServiceWorker] Notification click Received."),e.notification.close(),e.waitUntil(clients.openWindow("/"))}));